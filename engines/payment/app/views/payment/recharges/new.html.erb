<div class="panel panel-default">
  <div class="recharge-title"><p><%= t("simple_form.labels.payment/recharge.title") %></p></div>

  <%= simple_form_for(@recharge, url: user_recharges_path(@resource_user, @recharge)) do |f| %>
  <div class="row row-title">
    <div class="col-md-7 col-md-row" id="col-md-nav-1">
      <div class="col-md-title"><p><%= t("simple_form.labels.payment/recharge.amount") %></p></div>
      <div class="col-md-apply">
        <div class="txt-num">
          <%= f.text_field :amount, class: "num", placeholder: t("simple_form.placeholders.payment/recharge.amount", min_amount: 100) %>
          <span><%= t("simple_form.hints.payment/recharge.amount", blance: number_to_currency(@cash_account.balance, unit: '¥') ) %></span>
        </div>
      </div>
    </div>
    <div class="col-md-5 col-md-row" id="col-md-nav-2">
      <div class="col-md-title"><p><%= t("simple_form.labels.payment/recharge.pay_type") %></p></div>
      <div class="col-md-apply-1">
        <div class="txt-radio">
          <%= f.input :pay_type, label: false, as: :radio_buttons, collection: Payment::Recharge.pay_type.options.select {|item| item.last != "offline" || current_user.admin?  } %>
        </div>
      </div>
    </div>
  </div>
  <ul class="row-apply">
    <% @recharge.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end if @recharge.errors.present? %>

    <li><%= t("simple_form.labels.payment/recharge.confirm") %></li>
    <li>
      <em><%= t("simple_form.labels.payment/recharge.confirm_amount") %>:</em>
      <span><strong id="confirm_amount"><%= number_to_currency(@recharge.amount, unit: '¥') %></strong></span>
    </li>
    <li>
      <%= f.submit t("simple_form.actions.payment/recharge.submit"), class: 'btn-suc' %>
    </li>
  </ul>
  <% end %>
</div>

<%= content_for :javascript do %>
<script type="text/javascript">
$(function() {
  $("#recharge_amount").blur(function() {
    if(!parseFloat($("#recharge_amount").val())) return false;
    $("#confirm_amount").text("￥" + parseFloat($("#recharge_amount").val()));
  });

  $("#new_recharge").submit(function() {
    var amount = parseFloat($("#recharge_amount").val());
    if(!amount || amount <= 0 || amount != $("#recharge_amount").val()) {
      alert("充值金额不正确");
      $(this).removeClass("submiting");
      return false;
    }

    if($('.recharge_pay_type input:checked').size() == 0){
      alert('请选择支付方式');
      $(this).removeClass("submiting");
      return false;
    }
  });


});
</script>
<% end %>