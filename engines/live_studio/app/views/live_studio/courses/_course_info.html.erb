<% teacher = @course.teacher %>
<div class="col-md-9 col-md-left">
  <div class="panel panel-default">
    <div class="recommended-tutoring">
       <div class="tutoring-title">
         <div class="tutoring-title-left">
           <%= image_tag 'icon.png'%>
           <span class="title-size"><%= t('view.course_info_show.course_label')%></span>
         </div>
       </div>
       <div class="tec-data">
         <div class="data-con">
           <table border="0" cellspacing="0" cellpadding="0">
           <tr>
              <td rowspan="6">
                <%= image_tag @course.publicize_url(:info) %>
              </td>
              <td colspan="3">
                <div class="subject-title">
                <span><%= @course.name%></span><span><%= t('view.course_show.online')%></span>
                </div>
              </td>
            </tr>
            <tr>
              <td colspan="3"><span class="headline-color"><%= t('view.course_show.teacher')%></span><span class="title-color interval"><%= teacher.name%></span></td>
            </tr>
            <tr>
              <td><span class="headline-color"><%= t('view.course_info_show.subject')%></span><span class="title-color interval"><%= teacher.subject%></span></td>
              <td><span class="headline-color"><%= t('view.course_info_show.category')%></span> <span class="title-color interval"><%= teacher.category%></span></td>
              <td><span class="headline-color"><%= t("view.course_show.lesson_time") %></span> <span class="title-color interval">共<%= @course.lessons_count %>课</span></td>
            </tr>
            <tr>
              <td colspan="3">
                <span class="headline-color"><%= t("activerecord.view.date") %></span>
                <span class="title-color interval"><%= localize(@course.live_start_date, format: :short) %>-<%= localize(@course.live_end_date, format: :short) %></span>
              </td>
            </tr>
            <tr>
              <td colspan="3"><span class="headline-color"><%= t("activerecord.view.status") %></span>
                <span class="<%= @course.completed? ? 'separator' : 'title-color' %> interval">
                  <%= @course.status_text%>
                  (<%= @course.published? ? (t('view.course_show.distance_text1') % @course.distance_days) : "#{@course.completed_lesson_count}/#{@course.lessons_count }" %>)
                </span>
              </td>
            </tr>
            <tr>
              <td colspan="3">
                <div class="price-details">
                  <div class="unit-price">
                    <span class="title-color price-num">￥<%= '%0.2f' % @course.price %></span>
                    <span class="sign-up"><%= t('view.course_search_show.purchase_number') %><%= @course.buy_tickets_count%></span>
                  </div>
                  <%= render "buy_or_taste" if current_user.blank? || current_user.student? %>
                </div>
              </td>
            </tr>
          </table>
          <div class="data-introduction">
            <div class="introduction-title">
              <p><%= t('view.play.course_description')%></p>
            </div>
            <div class="introduction-con">
              <p><%= truncate(@course.description, length: 370, omission: '...') %></p>
            </div>
          </div>
        </div>
       </div>
    </div>
  </div>
</div>

<% content_for :javascript do %>
  <script>
    $(document).ready(function(){
      $("#taste-course-<%= @course.id %>").bind('ajax:success', function() {
        <% if current_user.present?%>
          window.location.reload();
        <% else %>
          window.location.href="/signin"
        <% end %>
      });
    })
  </script>
<% end %>
