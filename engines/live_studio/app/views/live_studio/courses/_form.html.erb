<%= simple_form_for @course do |f|%>
  <%= f.error_notification %>

  <h4>一、辅导概况</h4>

  <div class="form-inputs">
    <%=render 'course_fields', f: f%>
  </div>

  <h4>二、课程安排</h4>
  <div class="form-inputs">
    <table class="lesson_table">
      <%= f.fields_for :lessons do |lesson| %>
        <%= render 'lesson_fields', f: lesson%>
      <% end%>
    </table>
  </div>
  <div class="pull-right">
    <p><%= raw link_to_add_fields("增加一条新规则", f, :lessons, 'live_studio/courses/') %></p>
  </div>

  <div class="form-actions">
    <center>
      <a class="btn btn-primary">预览</a>
      <a class="btn btn-primary submit">发布</a>
    </center>
  </div>
<% end %>

<% content_for :javascript do %>
  <script>
    $(document).ready(function(){
      $('.remedial-date').each(function(_, el){
        $(el).click(function(){
          show_calendar(this)
        })
      })

      function show_calendar(el){
        $.jeDate(el, {
          insTrigger:false,
          //isinitVal:true,
          format:"YYYY-MM-DD", // 分隔符可以任意定义，该例子表示只显示年月
          isClear:false,
          festival: true, //显示节日
          minDate: '2000-06-01', //设定最小日期为当前日期
          //最大日期
        });
      }

      $('.submit').click(function(){
        $('form').submit();
      })

    })
  </script>
<% end %>



<script>
  $('.selectpicker').selectpicker({
    style: 'btn-default show-tick',
    size: 4,
    'data-live-search': "true"
  });

  $(function(){
    $(".lesson_price_item").change(function(){
      var price = parseInt($("#course_price").val());
      var lesson_count = parseInt($("#course_preset_lesson_count").val());
      var lesson_price = lesson_count === 0 ? 0 : price / lesson_count;
      lesson_price = Math.floor(lesson_price);
      $("#course_price").siblings(".help-block").text("<%= LiveStudio::Course.human_attribute_name(:lesson_price) %>" + lesson_price);
    });
  });
</script>
